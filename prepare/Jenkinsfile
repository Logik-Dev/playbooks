node {
    stage('Clone') {
        checkout scm
    }
    stage('Run') {
        sshagent(['SSH']) {
            ansiblePlaybook (
                become: true, 
                colorized: true, 
                credentialsId: 'SSH', 
                extras: "--extra-vars='public_key=$PUBLIC_KEY'", 
                inventory: 'hosts.yml', 
                playbook: 'prepare/playbook.yml', 
                vaultCredentialsId: 'VAULT',
                disableHostKeyChecking: true
            )
        }
    }
}
